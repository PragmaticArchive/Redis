# Redis 알아보기

---

### 1. Redis 란

- 다수의 서버를 사용하는 분산환경의 서버가 공유하는 해시테이블.
- Redis = Remote Dictionary Server.
    - Remote Server : Redis가 각각의 서버 내에 로컬하게 존재하지 않고, 다수의 서버에서 공통적으로 사용할 수 있도록 원격에 존재한다.
    - Dictionary : 해시테이블과 같이 상수의 시간복잡도로 사용가능하다.
- 표준 C로 작성된 오픈소스 인메모리 데이터 저장소 : 백업을 제외한 모든 데이터를 RAM에 저장한다.
    - 일반적으로 RAM은 디스크에 비해 매우 빠르다.

---

**특징**

- In-Memory : 모든 데이터를 RAM에 저장( 백업/스냅샷 제외 ).
- Single Threaded : 단일 thread에서 모든 task 처리.
- Cluster Mode : 다중 노드에 데이터를 분산 저장하여 안정성 & 고가용성 제공.
- Persistence : RDB(Redis Database) + AOF(Append Only File) 통해 영속성 옵션 제공.
- Pub/Sub : Pub/Sub 패턴을 지원하여 손쉬운 애플리케이션 개발( eg. 채팅, 알림 등 ).

---

**장점**

- 높은 성능 : 모든 데이터를 메모리에 저장하기 때문에 매우 빠른 읽기/쓰기 속도 보장.
- Data Type 지원 : Redis에서 지원하는 Data Type을 잘 활용하여 다양한 기능 구현.
- 클라이언트 라이브러리 : Python, Java, Javascript 등 다양한 언어로 작성된 클라이언트 라이브러리 지원.
- 다양한 사례 / 강한 커뮤니티 : Redis를 활용하여 비슷한 문제를 해결한 사례가 많고, 커뮤니티 도움을 받기 쉬움.

---

**사용사례**

- Caching : 임시 비밀번호, 로그인 세션.
- Rate Limiter : 서버에서 특정 api에 대한 요청횟수 제한을 하기 위해 사용하는 기술.
- Message Broker : 메시지 큐.
- 실시간 분석 / 계산 : 순위표, 반경 탐색, 방문자 수 탐색.
- 실시간 채팅 : Pub/Sub 패턴.

---

### 2. Redis 영속성

- Redis는 주로 캐시로 사용되지만 데이터 영속성을 위한 옵션을 제공한다.
- SSD와 같은 영구적인 저장 장치에 데이터 저장.

---

**RDB(Redis Database, 영속성 옵션)**

- Point-in-time Snapshot : 특정 시간에 스냅샷을 생성하는 기술.
- 재난 복구 또는 복제에 주로 사용.
- 다만, 스냅샷 특성상
    - 스냅샷 생성시에 Redis 서버의 성능저하가 발생가능하다.
    - 스냅샷 이전의 데이터들에 일부 유실이 있을 수 있다.

---

**AOF(Append Only File, 영속성 옵션)**

- Redis에 적용되는 Write 작업을 모두 로그로 저장.
- 데이터 유실의 위험이 적지만, 재난 복구시 Write 작업을 다시 적용하기 때문에 RDB 보다 느림.

---

### 3. Caching

- 데이터를 빠르게 읽고 처리하기 위해 임시로 저장하는 기술.
- 계산된 값을 임시로 저장해두고, 동일한 계산/요청 발생시 다시 계산하지 않고 저장된 값 바로 사용.
- 캐시(Cache) = 임시 저장소.
- 사용 사례 :
    - CPU 캐시 : CPU와 RAM의 속도 차이로 발생하는 지연을 줄이기 위해 L1, L2, L3 캐시 사용.
    - 웹 브라우저 캐싱 : 웹 브라우저가 웹 페이지 데이터를 로컬 저장소에 저장하여 해당 페이지 재방문시 사용.
    - DNS 캐싱 : 이전에 조회한 도메인 이름과 해당하는 IP 주소를 저장하여 재요청시 사용.
    - 데이터베이스 캐싱 : 데이터베이스 조회나 계산 결과를 저장하여 재요청시 사용.
    - CDN : 원본 서버의 컨텐츠를 PoP 서버에 저장하여 사용자와 가까운 서버에서 요청 처리.
    - 애플리케이션 캐싱 : 애플리케이션 데이터나 계산 결과를 캐싱하여 반복적 작업 최적화.

---

**Cache Hit / Cache Miss**

- Cache Hit : 요청한 데이터가 정상적으로 응답되는 경우.
- Cache Miss : Key가 잘못되었거나 요청한 데이터가 이미 만료되어 데이터를 응답하지 못하는 경우.

---

**Cache-Aside Pattern**

- 애플리케이션에서 클라이언트 요청을 처리할 때, 먼저 캐시를 조회하여 캐시가 존재한다면(cache hit) 캐시 데이터를 사용하고, 존재하지 않는다면(cache miss) 원본 스토리지를 조회하여 데이터를 사용하고 해당 데이터를 캐싱하는 패턴.
